### [Вернуться на Главную](/README.md)

### Что такое Docker 
- **Docker** — это инструмент для упаковки приложения и всех его зависимостей (рантайм, библиотеки, системные файлы) в легковесный переносимый юнит, называемый **контейнером**.
- **Контейнеры vs ВМ**: контейнеры используют общий с хостом ядро ОС и значительно легче/быстрее виртуальных машин.

### Базовые понятия
- **Образ (Image)**: шаблон только для чтения (например, `node:18-alpine`). Образы собираются из `Dockerfile`.
- **Контейнер**: запущенный экземпляр образа.
- **Dockerfile**: инструкции для сборки образа.
- **Реестр (Registry)**: хранилище образов (например, Docker Hub).
- **Тома (Volumes)**: постоянное хранилище для контейнеров.
- **Сети (Networks)**: как контейнеры общаются между собой.

### Зачем разработчики используют Docker
- **Консистентность**: «Работает у меня» превращается в «Работает везде, где запущен образ».
- **Изоляция**: избегает конфликтов зависимостей между проектами.
- **Скорость**: быстрый старт и остановка по сравнению с ВМ.
- **Портируемость**: один и тот же образ в dev, CI и production.

### Типовой рабочий процесс для новичка
1. Выберите базовый образ (например, `python:3.11-slim`).
2. Напишите `Dockerfile`.
3. Соберите образ: `docker build -t my-app .`
4. Запустите контейнер: `docker run -p 3000:3000 my-app`
5. Опубликуйте: `docker push <your-registry>/my-app:tag`

### Минимальные примеры
- Dockerfile (Node.js веб‑приложение):
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3000
CMD ["node", "server.js"]
```

- Часто используемые команды:
```bash
docker ps                    # Список запущенных контейнеров
docker images                # Список образов
docker build -t my-app .     # Сборка образа
docker run -p 3000:3000 my-app
docker logs <container>      # Просмотр логов
docker exec -it <container> sh
docker stop <container> && docker rm <container>
```

### Docker Compose (мультисервисные приложения)
- Используйте `docker-compose.yml`, чтобы запускать несколько сервисов вместе (например, приложение + база данных).
```yaml
services:
  web:
    build: .
    ports: ["3000:3000"]
    depends_on: [db]
  db:
    image: postgres:16
    environment:
      POSTGRES_PASSWORD: example
    volumes:
      - db_data:/var/lib/postgresql/data
volumes:
  db_data:
```
- Запуск: `docker compose up --build`

### Данные и персистентность
- **Без томов**: данные исчезают при удалении контейнера.
- **С томами/маунтами**: данные сохраняются между перезапусками.
  - Именованный том: `-v db_data:/var/lib/postgresql/data`
  - Привязанный маунт (папка хоста): `-v ${PWD}:/app`

### Основы сети
- **Bridge‑сеть** (по умолчанию): в Compose контейнеры достигают друг друга по имени сервиса.
- Пробрасывайте порты на хост с `-p host:container` (например, `-p 8080:80`).

### Рекомендации для новичков
- **Используйте slim/alpine‑образы** для меньшего размера.
- **Фиксируйте версии** (например, `node:18-alpine`) для воспроизводимости.
- **.dockerignore** чтобы не копировать лишние файлы.
- **Кеширование слоев**: помещайте наименее изменяемые шаги раньше (например, `COPY package*.json` перед `COPY . .`).
- **Запускайте процессы не от root** внутри контейнеров, где возможно.
- **Один процесс на контейнер** (а сервисы связывайте через Compose).

### Частые ошибки
- **Огромные образы**: используйте slim‑базы и многостадийную сборку.
- **Проблемы с правами** на маунтах: согласуйте UID/GID или используйте `--user`.
- **Конфликты портов**: меняйте порт на хосте, если занят.
- **Отсутствие томов для БД**: приводит к потере данных при удалении контейнера.

### Заметки для Windows (ваша среда)
- Установите Docker Desktop for Windows. Он использует WSL 2 для Linux‑контейнеров.
- Для лучшей производительности держите файлы проекта в файловой системе WSL 2, либо аккуратно настраивайте шаринг Windows‑путей.
- Используйте PowerShell или терминал WSL; команды одинаковые.

### Маршрут обучения
- Запустите официальный образ: `docker run -it alpine sh`
- Контейнеризируйте небольшое приложение с помощью `Dockerfile`
- Добавьте базу данных через Docker Compose
- Публикуйте/загружайте образы в Docker Hub
- Освойте логи, `exec`, тома и сети

Если хотите, скажите ваш язык/фреймворк — подготовлю для вас подходящие `Dockerfile` и `docker-compose.yml`.